// Autogenerated from models/ps30m/template/build.tmpl

package main

import (
	"github.com/merliot/dean"
	"github.com/merliot/sw-poc/models/ps30m"
)

func main() {
	thing := ps30m.New("{{.id}}", "{{.model}}", "{{.name}}").(*ps30m.Ps30m)

	if "{{.demo}}" == "true" {
		thing.Demo()
	}

	server := dean.NewServer(thing)

	if "{{.hub}}" != "" {
		server.DialWebSocket("{{.user}}", "{{.passwd}}", "{{.scheme}}{{.hub}}/ws/1500", thing.Announce())
	}

	if "{{.port}}" != "" {
		server.BasicAuth("{{.user}}", "{{.passwd}}")
		server.Addr = ":{{.port}}"
		go server.ListenAndServe()
	}

	server.Run()
}
