// Autogenerated from server.tmpl

package main

import (
	"github.com/merliot/dean"
	"github.com/merliot/hub/models/{{.model}}"
)

func main() {
	thing := {{.model}}.New("{{.id}}", "{{.model}}", "{{.name}}").(*{{.model}}.{{.modelStruct}})

	if "{{.demo}}" == "on" {
		thing.Demo()
	}

	server := dean.NewServer(thing)

	if "{{.hub}}" != "" {
		server.DialWebSocket("{{.user}}", "{{.passwd}}", "{{.scheme}}{{.hub}}/ws/1500", thing.Announce())
	}

	if "{{.http}}" == "on" {
		server.BasicAuth("{{.user}}", "{{.passwd}}")
		if "{{.port}}" != "" {
			server.Addr = ":{{.port}}"
		}
		go server.ListenAndServe()
	}

	server.Run()
}
