// Autogenerated from runner.tmpl

package main

import (
	"github.com/merliot/dean"
	"github.com/merliot/dean/tinynet"
	"github.com/merliot/hub/models/{{.model}}"
)

func main() {

	tinynet.NetConnect("{{.ssid}}", "{{.passphrase}}")

	thing := {{.model}}.New("{{.id}}", "{{.model}}", "{{.name}}").(*{{.model}}.{{.modelStruct}})

	thing.SetDeployParams("{{.deployParams}}")

	runner := dean.NewRunner(thing)

{{template "runner-extras.tmpl" .}}
	if "{{.hub}}" != "" {
		runner.DialWebSocket("{{.user}}", "{{.passwd}}", "{{.wsscheme}}{{.hub}}/ws/", thing.Announce())
	}

	if "{{.backuphub}}" != "" {
		runner.DialWebSocket("{{.user}}", "{{.passwd}}", "{{.backupwsscheme}}{{.backuphub}}/ws/", thing.Announce())
	}

	runner.Run()
}
