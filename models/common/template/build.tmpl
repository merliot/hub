// Autogenerated from build.tmpl

package main

import (
	"github.com/merliot/dean"
	"github.com/merliot/sw-poc/models/{{.model}}"
)

func main() {
	thing := {{.model}}.New("{{.id}}", "{{.model}}", "{{.name}}").(*{{.model}}.{{.modelStruct}})

	if "{{.demo}}" == "true" {
		thing.Demo()
	}

	server := dean.NewServer(thing)

	if "{{.hub}}" != "" {
		server.DialWebSocket("{{.user}}", "{{.passwd}}", "{{.scheme}}{{.hub}}/ws/1500", thing.Announce())
	}

	if "{{.port}}" != "" {
		server.BasicAuth("{{.user}}", "{{.passwd}}")
		server.Addr = ":{{.port}}"
		go server.ListenAndServe()
	}

	server.Run()
}
